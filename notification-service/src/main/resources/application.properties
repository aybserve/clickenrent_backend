spring.application.name=notification-service
info.author=Vitaliy Shvetsov

#PROFILE CONFIGURATION
# Spring Boot automatically reads SPRING_PROFILES_ACTIVE from environment
# DotenvConfig loads .env file, which contains SPRING_PROFILES_ACTIVE=staging

server.port=8085

# Eureka
eureka.client.service-url.defaultZone=http://localhost:8761/eureka/
eureka.client.register-with-eureka=true
eureka.client.fetch-registry=true
eureka.instance.prefer-ip-address=true


# Database
spring.datasource.url=${DB_URL:jdbc:postgresql://localhost:5432/clickenrent-notification}
#spring.datasource.url=${DB_URL:jdbc:postgresql://localhost:5432/clickenrent-notification-staging}
spring.datasource.username=${DB_USERNAME:postgres}
spring.datasource.password=${DB_PASSWORD}
spring.datasource.driver-class-name=org.postgresql.Driver

# JPA / HIBERNATE CONFIG
# PRODUCTION (default): ddl-auto=none â€” Flyway owns all schema changes
# STAGING: application-staging.properties overrides to ddl-auto=update
spring.jpa.hibernate.ddl-auto=${JPA_DDL_AUTO:update}
spring.jpa.show-sql=${JPA_SHOW_SQL:false}
spring.jpa.properties.hibernate.format_sql=true
spring.jpa.database-platform=org.hibernate.dialect.PostgreSQLDialect

# Flyway Configuration
# Spring Boot's auto-config is ALWAYS disabled; our custom FlywayConfig.java
# runs Flyway AFTER Hibernate DDL (relevant when staging profile uses ddl-auto=update).
# Sample/test data is loaded only when 'staging' or 'dev' profile is active.
spring.flyway.enabled=false
flyway.migrate.enabled=${FLYWAY_MIGRATE:true}
flyway.skip.testdata=${FLYWAY_SKIP_TESTDATA:false}

# DATA INITIALIZATION CONFIG (fallback mode when Flyway is disabled)
# Set SQL_INIT_MODE=always and FLYWAY_MIGRATE=false to use data.sql instead of Flyway
spring.sql.init.mode=${SQL_INIT_MODE:never}
spring.jpa.defer-datasource-initialization=true

# JWT
# Development settings
jwt.secret=${JWT_SECRET}
# Access token expiration: 24 hours (in milliseconds)
jwt.expiration=${JWT_EXPIRATION:86400000}
# Refresh token expiration: 7 days (in milliseconds)
jwt.refresh-expiration=${JWT_REFRESH_EXPIRATION:604800000}
# Production settings
# Access token: 15 minutes (good balance)
#jwt.expiration=${JWT_EXPIRATION:900000}
# Refresh token: 7 days (your current setting is good)
#jwt.refresh-expiration=${JWT_REFRESH_EXPIRATION:604800000}

# Expo API
expo.api.url=https://exp.host/--/api/v2/push/send

# Actuator
management.endpoints.web.exposure.include=health,info,metrics
management.endpoint.health.show-details=when-authorized
management.health.eureka.enabled=false

# Logging
logging.level.org.clickenrent.notificationservice=INFO
logging.level.org.springframework.web=INFO

# Multi-Tenant Security
tenant.validation.enabled=true

# Sentry Configuration
# Leave empty to disable Sentry, or set SENTRY_DSN_NOTIFICATION in .env file
sentry.dsn=${SENTRY_DSN_NOTIFICATION:}
sentry.environment=${SENTRY_ENVIRONMENT:production}
sentry.release=1.0-SNAPSHOT@notification-service
sentry.traces-sample-rate=${SENTRY_TRACES_SAMPLE_RATE:1.0}
sentry.send-default-pii=false
sentry.enable-tracing=true
sentry.logging.minimum-event-level=error
sentry.logging.minimum-breadcrumb-level=info
sentry.tags.service=notification-service